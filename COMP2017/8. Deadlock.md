- Deadlock
	- two or more processes are waiting for each other to proceed
	- consequences
		- the processes involved cannot run
		- the resources held by these processes are tied up and wasted
	- Handling deadlock
		- Prevent or avoid deadlock
		- Detect the deadlock and recover from it
		- Do nothing

- Resource Model
	- computer has several types of resources
		- each type is composed of identical units
		- "one unit of resource" is referred to as "resource"

- Deadlock Prevention
	- ensure that at least one of the four necessary conditions does not hold
	- Necessary Conditions for Deadlock
		1. Mutual exclusion
			- each resource can be allocated to at most one process at a time
		2. Hold and wait
			- a process holds certain resources and waits for additional resources
		3. No preemption
			- resources cannot be preempted
			- if preemptive
				- OS copies the data to hard disk to prevent data loss
		4. Circular wait
			- Process P1 is waiting for a resource held by process P2
			- Process P2 is waiting for a resource held by process P3
			- ...
			- Process Pn is waiting for a resource held by process P1
- Deadlock Avoidance
	- system states
		- safe
			- all processes will have enough resources to complete execution
		- unsafe
			- otherwise
	- if actual need is equal to the maximum need for every process
		- unsafe state results in deadlock
	- if actual need is smaller than the maximum need
		- unsafe state may not result in deadlock
	- safe state does not have deadlock
	- safe state may transit to an unsafe state
	- The OS only performs the resource allocation that will result in a safe state
	- Banker's Algorithm
		- When a process enters the system, it declares the maximum need of each resource type
		- When a process requests some resources, the OS determines whether this resource allocation will result in a safe state
		- disadvantage
			- Each process must state the maximum need of each resource type in advance
- Deadlock Detection
	- resource allocation graph
		- removing arrows
			- If a process only has arrows pointing toward it (i.e., all of its resource needs have been fulfilled), remove these arrows
			- If a resource only has arrows pointing away from it (i.e., all the requests for this resource have been fulfilled), remove these arrows
			- If a resource unit can be allocated to an outstanding request, do so and change the arrow direction accordingly
		- if dos not contain any arrow
			- there is no deadlock
		- else
			- there is a deadlock
	- When to detect deadlock
		- when a request for resource cannot be fulfilled immediately
		- if a process has been waiting for resources for a significant duration
- Deadlock Recovery
	- select and terminate one process to release the resource
	- human policy
		- human factors or technical factors
			- who is the owner of a process
			- how long a process has been executing
			- how many resources the process holds

- Microsoft Windows does not handle deadlock
	- target for general applications/users
		- consequence of deadlock may be mild
	- primarily single-user OS
		- chance of deadlock is small