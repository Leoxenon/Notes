- PL
	- The Procedure language
	- allows to write a program
	- combines multiple SQL statement
		- Bind variables
			- :var
		- Block
			- end with .
		- Types of local variables
			- can be NUMBER
			- can be specified as the type of an existing column
				- tmpBalance ACCOUNT.balance%TYPE
			- can be a tuple of a table
				- tmpTuple ACCOUNT%ROWTYPE
		- Block body
			- consists of any number of SELECT, INSERT, DELETE, UPDATE statements
			- stand-alone SELECT statements
				- The query must return only a single tuple
				- All attributes of the returned tuple must be stored in local variables of the block
- Find the variance of students' scores
```sql
VARIABLE var NUMBER; 

DECLARE 
	n NUMBER;
	a NUMBER; 
	v NUMBER; 
BEGIN 
	SELECT COUNT(*), AVG(score) INTO n, a
		FROM STU; 
	SELECT SUM((score– a) * (score– a)) INTO v
		FROM STU; 
	:var := v / n; 
END; 
. 
PRINT :var;
```


- Flow controls in the bock body
	- IF … THEN … ELSE … END IF; 
	- IF … THEN … 
		- ELSIF … 
		- ELSIF … 
		- END IF; 
	- LOOP … EXIT WHEN … END LOOP; 
	- WHILE … LOOP … END LOOP;
	- FOR … IN< value > .. < value >LOOP … END LOOP

- Cursors
	- can return more than one tuple
```sql
DECLARE
	a NUMBER; id NUMBER; 
	CURSOR tran-cursor IS 
		SELECT stu-id FROM TRAN; 
BEGIN 
	OPEN tran-cursor;
	LOOP
		FETCH tran-cursor INTO id; 
		EXIT WHEN tran-cursor%NOTFOUND;
		SELECT AVG(score) INTO a FROM TRAN WHERE stu-id = id; 
		IF a > 90 THEN 
			INSERT INTO FIRST-CLASS-CAND VALUES (id, a); 
		END IF;
	END LOOP; 
	CLOSE tran-cursor; 
END;
```

- Procedures
	- Functions
	- IN variable
		- passing a value into the procedure
		- can not be assigned
```sql
CREATE OR REPLACE PROCEDURE inquire-first-class 
	(id NUMBER) AS a NUMBER; result INTEGER; 
BEGIN 
	result := 0; 
	SELECT AVG(score) INTO a FROM TRAN WHERE stu-id = id; 
	IF a > 90 THEN
		result := 1; 
	END IF; 
	IF result = 0 THEN
		DBMS_OUTPUT.PUT_LINE(id || ': Your average is not above 90');
	ELSE 
		DBMS_OUTPUT.PUT_LINE(id || ': Your average is above 90'); 
	END IF; 
END;


BEGIN 
	inquire_first_class(100);
END;
```
```
DROP PROCEDURE inquire-first-class;
```
